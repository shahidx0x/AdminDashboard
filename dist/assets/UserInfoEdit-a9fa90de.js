import{u as Q,a as W,r as d,b as Z,c as q,e as G,d as J,f as K,j as e,S as O,P as X,B as p,L as A,W as Y,U as D,g as U,M as u,h as ee,I as c,C,i as B,y as se,s as le}from"./index-df24c022.js";import{g as ae}from"./BrandServices-9fbd6d36.js";import{S as I}from"./SelectPicker-00c5e6c5.js";function te(x,n){const i=new FileReader;i.onloadend=()=>{n(i.result)},i.readAsDataURL(x)}function pe(){var v,w;const x=Q(s=>s.user.user),n=W(),[i,m]=d.useState(!1),[h,j]=d.useState(null),[t,_]=d.useState({fileUrl:""}),l=(v=Z().state)==null?void 0:v.myData,[b,P]=d.useState(void 0),[L,F]=d.useState(void 0),{register:r,control:N,watch:V,handleSubmit:k,formState:{errors:re}}=q({defaultValues:{isAccountActive:l==null?void 0:l.isAccountActive}});V("isAccountActive");const{data:f,status:oe}=G(["brandsIdName",x.jwt],ae),E=[...((w=f==null?void 0:f.data)==null?void 0:w.map(s=>({label:s==null?void 0:s.name,value:s.id,slug:s.slug})))||["loading"]].map(s=>({label:s==null?void 0:s.label,value:(s==null?void 0:s.value)+","+s.slug})),y=J(le),z=s=>{t.fileUrl!==""?s.profilePicture=t.fileUrl:s.profilePicture="",s.company=L,b&&(s.company_slug=b.split(",")[1],s.companyAssignedBy="Admin"),s.company===void 0&&(s.company=l.company);const a=l.ac_status,o=s.ac_status,S=a!==o&&(o===1||o===-1);o===1&&(s.isAccountActive=!0),console.log(S),y.mutate({data:s,token:x.jwt},{onSuccess:$=>{if(n.push(e.jsx(u,{type:"success",children:"Updated successfully"})),S){const R=o===1?"accept":"reject";se.post(`${U.endpoints.host}/notify/user/${s.email||l.email}/${R}`).then(H=>{}).catch(H=>{n.push(e.jsx(u,{type:"error",children:"Notification failed!"}))})}g(-1)},onError:$=>{n.push(e.jsx(u,{type:"error",children:"Update failed!"}))}})},M=[{label:"Active",value:1},{label:"Reject",value:-1}].map(s=>({label:s.label,value:s.value})),g=K();function T(){g("/dashbord/user-table")}return e.jsx(e.Fragment,{children:e.jsx(O,{justifyContent:"center",alignItems:"center",direction:"column",className:"mt-14 2xl:-ml-28 px-8 w-full",children:e.jsx(X,{bordered:!0,className:"shadow-sm -mt-10 border-l-8 border-l-indigo-400",style:{background:"#fff"},header:e.jsxs(e.Fragment,{children:[e.jsxs(p,{className:"text-sm font-mono",children:[e.jsx(p.Item,{as:A,to:"/dashbord",children:"Home"}),e.jsx(p.Item,{as:A,to:"/dashbord/user-table",children:"user-list"}),e.jsx(p.Item,{active:!0,className:"text-blue-400",children:"user-information-edit"})]}),e.jsx("h3",{className:"font-bold p-5 text-2xl bg-indigo-500 rounded-lg text-white",children:"Update User Information"})]}),children:e.jsxs("form",{onSubmit:k(z),children:[e.jsx("div",{className:"flex  flex-col justify-center items-center mb-10",children:e.jsx(Y,{color:(t==null?void 0:t.fileUrl)!==""?"green":"red",content:(t==null?void 0:t.fileUrl)!==""&&"uploaded",children:e.jsx(D,{fileListVisible:!1,listType:"picture",action:`${U.endpoints.host}/upload`,onUpload:s=>{m(!0),te(s.blobFile,a=>{j(a)})},onSuccess:(s,a)=>{m(!1),n.push(e.jsx(u,{type:"success"})),_(s)},onError:()=>{j(null),m(!1),n.push(e.jsx(u,{type:"error"}))},children:e.jsxs("button",{type:"button",style:{width:150,height:150},children:[i&&e.jsx(ee,{backdrop:!0,center:!0}),h?e.jsx("img",{src:h,width:"100%",height:"150%"}):e.jsx("img",{src:l==null?void 0:l.profilePicture,alt:"Profile Picture"})]})})})}),e.jsxs("div",{className:"",children:[e.jsx("div",{className:"flex  p-5",children:e.jsxs("div",{className:"flex flex-col 2xl:flex-row gap-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"First Name"}),e.jsx(c,{...r("firstName"),defaultValue:l==null?void 0:l.firstName,className:"w-56"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Last Name"}),e.jsx(c,{...r("lastName"),defaultValue:l==null?void 0:l.lastName,className:"w-56"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Email"}),e.jsx(c,{value:l==null?void 0:l.email,...r("email"),className:"w-56"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Phone Number"}),e.jsx(c,{...r("phoneNumber"),defaultValue:(l==null?void 0:l.phoneNumber)||"Not Available",className:"w-56"})]})]})}),e.jsxs("div",{className:"flex  p-5 flex-col 2xl:flex-row gap-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Cart Number"}),e.jsx(c,{...r("cartNumber"),defaultValue:l==null?void 0:l.cartNumber,className:"w-56"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Zip Code"}),e.jsx(c,{...r("zipCode"),defaultValue:l==null?void 0:l.zipCode,className:"w-56"})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{className:"font-bold",children:"Company"}),e.jsx(C,{name:"company",control:N,render:({field:s})=>e.jsx(I,{placeholder:l==null?void 0:l.company,searchable:!0,...s,size:"md",data:E,className:"w-56",onChange:(a,o)=>{s.onChange(a),F(o.target.innerHTML),P(a)},onBlur:()=>s.onBlur()})})]}),e.jsx("div",{className:"flex gap-5",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Location"}),e.jsx(c,{...r("location"),defaultValue:l==null?void 0:l.location,className:"w-56"})]})})]}),e.jsxs("div",{className:"mt-10 flex gap-5",children:[e.jsx("p",{className:"font-bold",children:"Account Activation Status :"}),e.jsx(C,{name:"ac_status",control:N,render:({field:s})=>e.jsx(I,{searchable:!1,placeholder:(l==null?void 0:l.ac_status)===0?"Pending":(l==null?void 0:l.ac_status)===1?"Active":"Rejected",...s,size:"md",data:M,className:"w-56 -mt-2",onChange:a=>s.onChange(a),onBlur:()=>s.onBlur()})})]}),e.jsxs("div",{className:"mt-5 flex gap-5",children:[e.jsx(B,{appearance:"ghost",onClick:()=>T(),children:"Cancel"}),e.jsx(B,{type:"submit",appearance:"primary",className:"bg-blue-600",children:"Update"})]})]})]})})})})}export{pe as default};
