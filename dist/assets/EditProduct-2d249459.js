import{u as Z,a as ee,r as t,b as se,j as s,S as ae,c as re,B as I}from"./index-104c432a.js";import{u as te,C as b}from"./index.esm-570ae98e.js";import{u as oe}from"./find-512bfdca.js";import{u as f}from"./useQuery-378f48db.js";import{g as ne}from"./BrandServices-40cf72d4.js";import{a as le}from"./CategoryService-21df62d7.js";import{c as de}from"./ProductService-133937d5.js";import{g as ce}from"./SubCategoryServices-d6aa268c.js";import{c as B}from"./api.config-65890cae.js";import{u as ie}from"./useToaster-edadc10d.js";import{P as ue}from"./Panel-1079ebd8.js";import{U as P}from"./Uploader-9d7745cc.js";import{M as h}from"./toaster-0bceac7b.js";import{I as l}from"./Input-e86552a4.js";import{S as N}from"./SelectPicker-9ddf4e78.js";import"./utils-0507c293.js";import"./AngleDown-aca6291a.js";import"./statusIcons-802c68e4.js";import"./propTypes-3043c6cf.js";import"./isArrayLikeObject-48b08de5.js";function me(d,c){const i=new FileReader;i.onloadend=()=>{c(i.result)},i.readAsDataURL(d)}function Re(){var v,C,w;const d=Z(e=>e.user.user),c=ie(),o=ee().state.myData,[U,u]=t.useState(!1),[y,m]=t.useState({product_image:o==null?void 0:o.product_image}),[L,S]=t.useState([]),[q,_]=t.useState(null),[F,M]=t.useState("brand"),[R,T]=t.useState(""),{data:p}=f(["brandsIdName",d.jwt],ne),{data:x}=f(["categoryIdName","",d.jwt,F,-1],le),{data:g}=f(["subCategoryIdName","",d.jwt,R,-1],ce),k=(v=x==null?void 0:x.data)==null?void 0:v.map(e=>({label:e==null?void 0:e.category_label,value:e._id})),E=(C=g==null?void 0:g.data)==null?void 0:C.map(e=>({label:e==null?void 0:e.subcategory_name,value:e._id})),z=[...((w=p==null?void 0:p.data)==null?void 0:w.map(e=>({label:e==null?void 0:e.name,value:e.id})))||["loading"]].map(e=>({label:e==null?void 0:e.label,value:e==null?void 0:e.value})),H=[...k||[{label:"No Category",value:"no-category"}]].map(e=>({label:e==null?void 0:e.label,value:e==null?void 0:e.value})),{register:r,control:j,reset:$,handleSubmit:A,formState:{errors:xe}}=te(),D=oe(de),[K,Q]=t.useState("No Brand"),[V,G]=t.useState("No Category"),[J,O]=t.useState("No Sub Category"),W=e=>{e.fet_image=[...L],e.product_image=q,e.brand_name=K,e.category_name=V,e.subcategory_name=J,D.mutate({data:e,token:d.jwt},{onSuccess:a=>{c.push(s.jsx(h,{type:"success",children:"Product updated successfully"})),m(null),_(null),S(null)},onError:a=>{c.push(s.jsx(h,{type:"error",children:"Product update failed !"}))}}),$()},X=o.fet_image.map((e,a)=>({name:`${a}.png`,fileKey:a+1,url:e}));se(),t.useState(null);const Y=e=>{console.log(e)};return s.jsx(s.Fragment,{children:s.jsx(ae,{justifyContent:"center",alignItems:"center",direction:"column",className:"mt-28 2xl:mt-5 ",style:{height:"100vh"},children:s.jsx(ue,{bordered:!0,className:"shadow-sm w-[48.5rem]",style:{background:"#fff"},header:s.jsx("h3",{className:"font-bold bg-indigo-700 p-8 text-2xl text-white rounded-lg",children:"Upadte Product Information"}),children:s.jsx("form",{onSubmit:A(W),children:s.jsxs("div",{children:[s.jsx("div",{className:"flex justify-center items-center mb-5 ",children:s.jsx(P,{fileListVisible:!1,listType:"picture",action:`${B.endpoints.host}/upload`,onUpload:e=>{u(!0),me(e.blobFile,a=>{m(n=>({...n,product_image:a}))})},onSuccess:(e,a)=>{u(!1),_(e.fileUrl)},onError:()=>{m(null),u(!1),c.push(s.jsx(h,{type:"error",children:"Upload failed"}))},children:s.jsxs("button",{type:"button",style:{width:150,height:150},children:[U&&s.jsx(re,{backdrop:!0,center:!0}),y?s.jsx("img",{src:y.product_image,width:"100%",height:"150%",alt:"product_picture"}):s.jsx("img",{src:o==null?void 0:o.product_image,alt:"product_picture"})]})})}),s.jsx("div",{className:"mt-3",children:s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Feature Image"}),s.jsx("div",{className:"flex",children:s.jsx(P,{disabled:!1,listType:"picture",defaultFileList:X,action:`${B.endpoints.host}/upload`,onSuccess:e=>S(a=>[...a,e.fileUrl]),onRemove:e=>{Y(e.url.split("/")[4])}})})]})}),s.jsxs("div",{className:"flex gap-5 mt-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Product Name"}),s.jsx(l,{required:!0,className:"w-[14.5rem]",...r("name")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Select Company"}),s.jsx(b,{name:"brand_id",...r("brand_id"),control:j,render:({field:e})=>s.jsx(N,{searchable:!0,...e,size:"md",data:z,className:"w-[14.5rem]",onChange:(a,n)=>{e.onChange(a),M(a),Q(n.target.innerHTML)},onBlur:()=>e.onBlur()})})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Select Category"}),s.jsx(b,{name:"category_id",...r("category_id"),control:j,render:({field:e})=>s.jsx(N,{searchable:!0,...e,size:"md",data:H,className:"w-[14.5rem]",onChange:(a,n)=>{e.onChange(a),G(n.target.innerHTML),T(a)},onBlur:()=>e.onBlur()})})]})]}),s.jsxs("div",{className:"flex gap-5 mt-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Select Sub Category"}),s.jsx(b,{name:"sub_category_id",...r("subcategory_id"),control:j,render:({field:e})=>s.jsx(N,{searchable:!0,...e,size:"md",data:E,className:"w-[14.5rem]",onChange:(a,n)=>{O(n.target.innerHTML),e.onChange(a)},onBlur:()=>e.onBlur()})})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Price"}),s.jsx(l,{className:"w-[14.5rem]",required:!0,...r("price")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Minimum Purchase"}),s.jsx(l,{className:"w-[14.5rem]",required:!0,...r("min_purchease")})]})]}),s.jsxs("div",{className:"flex gap-5  mt-3 ",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Maximum Purchase"}),s.jsx(l,{className:"w-[14.5rem]",required:!0,...r("max_purchease")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Base Price"}),s.jsx(l,{className:"w-[14.5rem]",required:!0,...r("base_price")})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:"Discount"}),s.jsx(l,{className:"w-[14.5rem]",required:!0,...r("discount")})]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold mt-3",children:"Description"}),s.jsx(l,{as:"textarea",required:!0,...r("des"),rows:3,placeholder:""})]}),s.jsxs("div",{className:"mt-10 flex gap-2",children:[s.jsx(I,{appearance:"ghost",children:"Cancel"}),s.jsx(I,{type:"submit","aria-required":!0,appearance:"primary",className:"bg-blue-600 font-bold",children:"Update Product"})]})]})})})})})}export{Re as default};
