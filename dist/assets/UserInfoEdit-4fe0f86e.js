import{u as G,a as J,r as u,b as O,c as W,e as X,d as Y,f as D,j as e,S as ee,P as se,B as h,L as y,as as te,U as ae,g as f,M as c,h as le,I as i,C as B,i as _,w as g,p as oe}from"./index-6260d541.js";import{g as ne}from"./BrandServices-a6d852ce.js";import{S as I}from"./SelectPicker-729090bc.js";function re(p,a){const d=new FileReader;d.onloadend=()=>{a(d.result)},d.readAsDataURL(p)}function xe(){var S,C;const p=G(s=>s.user.user),a=J(),[d,x]=u.useState(!1),[b,N]=u.useState(null),[o,P]=u.useState({fileUrl:""}),t=(S=O().state)==null?void 0:S.myData,[v,k]=u.useState(void 0),[F,L]=u.useState(void 0),{register:n,control:w,watch:V,handleSubmit:M,formState:{errors:ie}}=W({defaultValues:{isAccountActive:t==null?void 0:t.isAccountActive}});V("isAccountActive");const{data:j,status:de}=X(["brandsIdName",p.jwt],ne),T=[...((C=j==null?void 0:j.data)==null?void 0:C.map(s=>({label:s==null?void 0:s.name,value:s.id,slug:s.slug})))||["loading"]].map(s=>({label:s==null?void 0:s.label,value:(s==null?void 0:s.value)+","+s.slug})),E=Y(oe),z={notification:{title:"Check this Mobile (title)",body:"Rich Notification testing (body)",mutable_content:!0,sound:"Tri-tone",image:"https://firebase.google.com/images/social.png"},data:{title:"New Text Message",image:"https://firebase.google.com/images/social.png",message:"Hello how are you?"}},$=s=>{o.fileUrl!==""?s.profilePicture=o.fileUrl:s.profilePicture="",s.company=F,v&&(s.company_slug=v.split(",")[1],s.companyAssignedBy="Admin"),s.company===void 0&&(s.company=t.company);const l=t.ac_status,r=s.ac_status,K=l!==r&&(r===1||r===-1);r===1&&(s.isAccountActive=!0),E.mutate({data:s,token:p.jwt},{onSuccess:Q=>{if(a.push(e.jsx(c,{type:"success",children:"Updated successfully"})),K){const Z=r===1?"accept":"reject";g.post(`${f.endpoints.host}/notify/user/${s.email||t.email}/${Z}`).then(m=>{}).catch(m=>{a.push(e.jsx(c,{type:"error",children:"Notification failed!"}))}),g.post(f.endpoints.host+"/notifications",{message:"Account is active  ",user_email:s.email,category:"notification"});try{for(const m of t.firebaseFCM){const U={...z,to:m};console.log(U),g.post("https://fcm.googleapis.com/fcm/send",U,{headers:{"Content-Type":"application/json",Authorization:`key=${f.endpoints.fcmKey}`}}).then(q=>console.log(q))}a.push(e.jsx(c,{type:"success",children:"App Notification sucessfully send!"}))}catch{a.push(e.jsx(c,{type:"error",children:"App Notification failed!"}))}}A(-1)},onError:Q=>{a.push(e.jsx(c,{type:"error",children:"Update failed!"}))}})},R=[{label:"Active",value:1},{label:"Reject",value:-1}].map(s=>({label:s.label,value:s.value})),A=D();function H(){A("/dashbord/user-table")}return e.jsx(e.Fragment,{children:e.jsx(ee,{justifyContent:"center",alignItems:"center",direction:"column",className:"mt-14 2xl:-ml-28 px-8 w-full",children:e.jsx(se,{bordered:!0,className:"shadow-sm -mt-10 border-l-8 border-l-indigo-400 ",header:e.jsxs(e.Fragment,{children:[e.jsxs(h,{className:"text-sm font-mono",children:[e.jsx(h.Item,{as:y,to:"/dashbord",children:"Home"}),e.jsx(h.Item,{as:y,to:"/dashbord/user-table",children:"user-list"}),e.jsx(h.Item,{active:!0,className:"text-blue-400",children:"user-information-edit"})]}),e.jsx("h3",{className:"font-bold p-5 text-2xl bg-indigo-500 rounded-lg text-white",children:"Update User Information"})]}),children:e.jsxs("form",{onSubmit:M($),children:[e.jsx("div",{className:"flex  flex-col justify-center items-center mb-10",children:e.jsx(te,{color:(o==null?void 0:o.fileUrl)!==""?"green":"red",content:(o==null?void 0:o.fileUrl)!==""&&"uploaded",children:e.jsx(ae,{fileListVisible:!1,listType:"picture",action:`${f.endpoints.host}/upload`,onUpload:s=>{x(!0),re(s.blobFile,l=>{N(l)})},onSuccess:(s,l)=>{x(!1),a.push(e.jsx(c,{type:"success"})),P(s)},onError:()=>{N(null),x(!1),a.push(e.jsx(c,{type:"error"}))},children:e.jsxs("button",{type:"button",style:{width:150,height:150},children:[d&&e.jsx(le,{backdrop:!0,center:!0}),b?e.jsx("img",{src:b,width:"100%",height:"150%"}):e.jsx("img",{src:t==null?void 0:t.profilePicture,alt:"Profile Picture"})]})})})}),e.jsxs("div",{className:"",children:[e.jsx("div",{className:"flex  p-5",children:e.jsxs("div",{className:"flex flex-col 2xl:flex-row gap-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"First Name"}),e.jsx(i,{...n("firstName"),defaultValue:t==null?void 0:t.firstName,className:"w-56"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Last Name"}),e.jsx(i,{...n("lastName"),defaultValue:t==null?void 0:t.lastName,className:"w-56"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Email"}),e.jsx(i,{value:t==null?void 0:t.email,...n("email"),className:"w-56"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Phone Number"}),e.jsx(i,{...n("phoneNumber"),defaultValue:(t==null?void 0:t.phoneNumber)||"Not Available",className:"w-56"})]})]})}),e.jsxs("div",{className:"flex  p-5 flex-col 2xl:flex-row gap-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Cart Number"}),e.jsx(i,{...n("cartNumber"),defaultValue:t==null?void 0:t.cartNumber,className:"w-56"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Zip Code"}),e.jsx(i,{...n("zipCode"),defaultValue:t==null?void 0:t.zipCode,className:"w-56"})]}),e.jsxs("div",{className:"",children:[e.jsx("p",{className:"font-bold",children:"Company"}),e.jsx(B,{name:"company",control:w,render:({field:s})=>e.jsx(I,{placeholder:t==null?void 0:t.company,searchable:!0,...s,size:"md",data:T,className:"w-56",onChange:(l,r)=>{s.onChange(l),L(r.target.innerHTML),k(l)},onBlur:()=>s.onBlur()})})]}),e.jsx("div",{className:"flex gap-5",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Location"}),e.jsx(i,{...n("location"),defaultValue:t==null?void 0:t.location,className:"w-56"})]})})]}),e.jsxs("div",{className:"mt-10 flex gap-5",children:[e.jsx("p",{className:"font-bold",children:"Account Activation Status :"}),e.jsx(B,{name:"ac_status",control:w,render:({field:s})=>e.jsx(I,{searchable:!1,placeholder:(t==null?void 0:t.ac_status)===0?"Pending":(t==null?void 0:t.ac_status)===1?"Active":"Rejected",...s,size:"md",data:R,className:"w-56 -mt-2",onChange:l=>s.onChange(l),onBlur:()=>s.onBlur()})})]}),e.jsxs("div",{className:"mt-5 flex gap-5",children:[e.jsx(_,{appearance:"ghost",onClick:()=>H(),children:"Cancel"}),e.jsx(_,{type:"submit",appearance:"primary",className:"bg-blue-600",children:"Update"})]})]})]})})})})}export{xe as default};
