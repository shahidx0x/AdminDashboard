import{r as l,u as A,a as fe,f as be,e as ye,d as R,j as e,P as Ce,B as j,L as E,k as u,g as P,l as ke,m as h,I as T,T as Ne,n as F,o as ve,p as K,R as Se,M as W,_ as f,q as we,A as Le}from"./index-9a22797f.js";import{g as $,d as Ie}from"./CategoryService-6c7c104a.js";function Fe(){var H,M,_;l.useState(!1);const[b,Be]=l.useState(!0);l.useState(!0);const[q,He]=l.useState(!1),[x,y]=l.useState(1);l.useState(!0),l.useState(!0);const[O,Me]=l.useState(!1);l.useState(!0);const m=A(t=>t.user.user),[G,V]=l.useState(""),[Q,C]=l.useState(!1);l.useState(!1);const k=fe(),N=be(),{Column:z,HeaderCell:v,Cell:o}=K,J=t=>e.jsx(o,{...t,style:{padding:4}}),U=t=>e.jsx(v,{...t,style:{padding:4},children:e.jsx("div",{className:"flex justify-center font-bold",children:t.children})}),{data:r,status:X,refetch:c}=ye(["category",x,m.jwt],$,{cacheTime:0}),[Y,g]=l.useState(!1),[Z,D]=l.useState(null),ee=()=>{g(!0)},te=R(Ie),se=()=>{te.mutate({deleteId:Z,token:m.jwt},{onSuccess:t=>{k.push(e.jsx(W,{type:"success",children:"Category deleted successfully"})),c(),g(!1)},onError:t=>{console.log(t.response),k.push(e.jsx(W,{type:"error",children:"Category delete failed !"}))}}),c()},S=()=>g(!1),w=({content:t,...s})=>e.jsx(o,{...s,children:e.jsx("p",{className:"flex justify-center items-center",children:t})}),p=[{key:"image",label:"Brand Image",cellRenderer:({rowData:t,...s})=>e.jsx(o,{...s,children:e.jsx("div",{className:"flex justify-center -mt-2",children:e.jsx(Le,{src:(t==null?void 0:t.image)||"https://universalele.websites.co.in/obaju-turquoise/img/product-placeholder.png",alt:"P"})})}),width:100},{key:"category_label",label:"Brand Name",cellRenderer:({rowData:t,...s})=>{const d=()=>{N(`/dashbord/subcategory/list/${t==null?void 0:t.category_label}/${t==null?void 0:t._id}`,{state:{rowData:t}})};return e.jsx(o,{...s,children:e.jsx("p",{onClick:d,className:"flex justify-center items-center text-blue-500 underline cursor-pointer font-bold hover:underline hover:cursor-pointer",children:t==null?void 0:t.category_label})})},width:200},{key:"product_count",label:"Product Count",cellRenderer:({content:t,rowData:s,...d})=>e.jsx(o,{...d,children:e.jsx("p",{className:"flex justify-center items-center font-bold",children:s.productCount})}),width:200},{key:"category_label",label:"Category Count",cellRenderer:t=>{var s;return e.jsx(w,{...t,content:((s=t.rowData)==null?void 0:s.subCategories.length)||0,className:"font-bold"})},width:150},{key:"brand_name",label:"Company Name",cellRenderer:t=>{var s;return e.jsx(w,{...t,content:(s=t.rowData)==null?void 0:s.brand_name})},width:250},{key:"actions",label:"Actions",cellRenderer:({rowData:t,...s})=>{const d=()=>{ee(),D(t._id)},i=()=>{N("/dashbord/category/edit",{state:{myData:t}})};return e.jsx(o,{...s,children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{type:"button",className:"text-blue-500 border px-3 py-2 -mt-1 hover:text-white hover:bg-indigo-500 rounded-lg",onClick:i,children:"Edit"}),e.jsx("button",{type:"button",className:"text-red-500 border px-3 py-2 -mt-1 rounded-lg hover:text-white hover:bg-red-500",onClick:d,children:"Delete"})]})})},width:200}],a=R($),le=t=>{V(t),t===""&&(c(),C(!1))},ne=()=>{C(!0),f.promise(a.mutateAsync({queryKey:["user_search",x,m.jwt,G]}),{loading:"Searching...",success:e.jsx("b",{children:"Category found!"}),error:e.jsx("b",{children:"Category not found in the database!"})})},re=Q&&((H=a==null?void 0:a.data)!=null&&H.data[0])?[(M=a==null?void 0:a.data)==null?void 0:M.data[0]]:r==null?void 0:r.data,[L,oe]=l.useState(p.map(t=>t.key)),ae=p.filter(t=>L.some(s=>s===t.key)),de=b?J:o,ce=b?U:v,ie=()=>{y(t=>{var s;return t<((s=r==null?void 0:r.meta)==null?void 0:s.total_pages)?t+1:t}),c()},ue=()=>{y(t=>Math.max(t-1,1)),c()},[he,I]=l.useState(!1),xe=t=>{t.target.value==="confirm"?I(!0):I(!1)},n=A(t=>t.settings),[B,me]=l.useState(null),ge=t=>{const s=t.target.files[0];me(s)},pe=async()=>{if(B){const t=new FormData;t.append("file",B),f.promise(we.post(P.endpoints.host+"/import/companys",t),{loading:"Importing Companys...",success:e.jsx("b",{children:"Successfully Imported"}),error:s=>e.jsx("p",{children:s.response.data.message})})}else console.log("No xlsx file sected"),f.error("No xlsx file sected")};return e.jsxs(Ce,{header:e.jsxs("div",{children:[e.jsxs(j,{className:"text-sm font-mono",children:[e.jsx(j.Item,{as:E,to:"/dashbord/status",children:"dashbord"}),e.jsx(j.Item,{active:!0,className:"text-blue-400",children:"Brands"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h2",{className:"text-4xl font-bold",children:"Brands"}),e.jsxs("div",{className:"flex gap-5",children:[e.jsxs("div",{className:"flex",children:[e.jsx("input",{onChange:ge,accept:".xlsx",type:"file",className:"border"}),e.jsx(u,{onClick:pe,className:"bg-indigo-200 text-indigo-500 font-bold",children:"Import Brands"})]}),e.jsx(u,{className:"bg-indigo-200 text-indigo-500 font-bold",children:e.jsx(E,{to:P.endpoints.host+"/export/brands",children:"Export Brands"})})]})]})]}),bordered:!0,children:[e.jsx(ke,{}),e.jsxs(h,{open:Y,onClose:S,children:[e.jsxs(h.Header,{className:"p-5",children:[e.jsx(h.Title,{className:"font-bold font-mono",children:"Are you sure ?"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{children:"All subcategory and product under this category will be deleted !"}),e.jsx(T,{className:"border-red-300",onChange:(t,s)=>xe(s),placeholder:"Type 'confirm' to delete"})]})]}),e.jsxs(h.Footer,{children:[e.jsx(u,{disabled:!he,onClick:se,className:"bg-blue-500 w-20",appearance:"primary",children:"Confirm"}),e.jsx(u,{className:" bg-red-500 text-white",onClick:S,children:"Cancel"})]})]}),e.jsxs("div",{children:[e.jsx("hr",{}),e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex flex-col 2xl:flex-row gap-3 2xl:justify-between",children:[e.jsx("div",{className:"",children:e.jsx(Ne,{className:"h-12",data:p,labelKey:"label",valueKey:"key",value:L,onChange:oe,cleanable:!1})}),e.jsx("div",{children:e.jsx("div",{className:" ",children:e.jsxs(F,{children:[e.jsx(T,{placeholder:"Search by Category Name",onChange:t=>le(t)}),e.jsx(F.Button,{onClick:()=>ne(),tabIndex:-1,children:e.jsx(ve,{className:"text-indigo-500 font-bold"})})]})})})]})}),e.jsx("hr",{}),e.jsxs("div",{className:"mt-5 ml-4",style:{height:n.autoHeight?"auto":400},children:[e.jsx(K,{loading:X==="loading",height:300,hover:n.hover,fillHeight:O,showHeader:n.header,autoHeight:n.autoHeight,data:q?[]:re,bordered:n.bordered,cellBordered:n.bordered,headerHeight:n.compact?40:30,rowHeight:n.compact?56:30,children:ae.map(t=>{const{key:s,label:d,cellRenderer:i,...je}=t;return l.createElement(z,{...je,key:s,fullText:!0},e.jsx(ce,{children:d}),i?Se.createElement(i,{dataKey:s}):e.jsx(de,{dataKey:s}))})}),e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex items-center justify-center py-10 lg:px-0 sm:px-6 px-4",children:e.jsxs("div",{className:"lg:w-3/5 w-full  flex items-center justify-between border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center pt-3 text-gray-600 hover:text-indigo-700 cursor-pointer",children:[e.jsxs("svg",{width:14,height:8,viewBox:"0 0 14 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M1.1665 4H12.8332",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M1.1665 4L4.49984 7.33333",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M1.1665 4.00002L4.49984 0.666687",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})]}),e.jsx("p",{onClick:ue,className:`text-sm ml-3 font-medium leading-none ${n.theme==="dark"&&"text-white"} `,children:"Previous"})]}),e.jsx("div",{className:"sm:flex hidden",children:e.jsxs("p",{className:`text-sm font-bold leading-none cursor-pointer text-gray-600 hover:text-indigo-700 border-t border-transparent hover:border-indigo-400 pt-3 mr-4 px-2 ${n.theme==="dark"&&"text-white"}`,children:["pages : ",x,"/",(_=r==null?void 0:r.meta)==null?void 0:_.total_pages]})}),e.jsxs("div",{className:"flex items-center pt-3 text-gray-600 hover:text-indigo-700 cursor-pointer",children:[e.jsx("p",{onClick:ie,className:`text-sm font-medium leading-none mr-3 ${n.theme==="dark"&&"text-white"}`,children:"Next"}),e.jsxs("svg",{width:14,height:8,viewBox:"0 0 14 8",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M1.1665 4H12.8332",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9.5 7.33333L12.8333 4",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M9.5 0.666687L12.8333 4.00002",stroke:"currentColor",strokeWidth:"1.25",strokeLinecap:"round",strokeLinejoin:"round"})]})]})]})})})]})]})]})}export{Fe as default};
